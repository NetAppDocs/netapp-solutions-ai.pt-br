---
sidebar: sidebar 
permalink: software/ai-hybrid-union.html 
keywords: NetApp AI, AI, Artificial Intelligence, ML, Machine Learning, Union.ai, Hybrid AI training 
summary: Implante um ambiente h√≠brido de treinamento de IA usando a orquestra√ß√£o Union.ai com o NetApp FlexCache para permitir que cargas de trabalho de treinamento de GPU baseadas em nuvem acessem dados locais de forma eficiente e segura. 
---
= Implante treinamento h√≠brido de IA com Union.ai e NetApp FlexCache.
:allow-uri-read: 


[role="lead"]
Aprenda como implantar um ambiente h√≠brido de treinamento de IA usando a orquestra√ß√£o Union.ai com NetApp FlexCache e Trident para provisionamento de armazenamento Kubernetes.

David Espejo, Union.ai Sathish Thyagarajan, NetApp



== Vis√£o geral

A plataforma de orquestra√ß√£o h√≠brida da Union.ai integra-se perfeitamente com o NetApp ONTAP e o FlexCache para acelerar os fluxos de trabalho de treinamento de IA/ML.  Essa solu√ß√£o permite que os dados permane√ßam em seguran√ßa no local, enquanto se aproveita o poder computacional da GPU na nuvem para cargas de trabalho de treinamento de IA.  O NetApp FlexCache garante que apenas os dados necess√°rios sejam armazenados em cache na nuvem, permitindo pipelines h√≠bridos de IA/ML eficientes, seguros e escal√°veis.



== Caso de uso do cliente: Treinamento de IA em nuvem h√≠brida

* Dados locais: armazenados no NetApp ONTAP para fins de conformidade e seguran√ßa.
* Computa√ß√£o em nuvem: Treinamento escal√°vel em GPU no EKS/GKE/AKS.
* Orquestra√ß√£o de IA/ML: Union.ai coordena o processamento de dados e o treinamento em diversos ambientes.
* Provisionamento de armazenamento: o NetApp Trident automatiza o provisionamento de PVC/PV.




== Valor para o cliente

* Execute cargas de trabalho de IA em conjuntos de dados massivos usando os recursos de escalabilidade horizontal do NetApp ONTAP.
* Transfira e sincronize dados entre ambientes locais e na nuvem usando os recursos de nuvem h√≠brida da NetApp.
* Armazene rapidamente dados locais em cache na nuvem usando o FlexCache.
* Union.ai simplifica a orquestra√ß√£o em diversos ambientes com controle de vers√£o, rastreamento de linhagem e gerenciamento de artefatos.
* Realize treinamentos na nuvem, mantendo os dados confidenciais em servidores locais.




== Ativar o Plugin ‚Äì Pr√©-requisitos

[cols="32%,68%"]
|===


| *Exig√™ncia* | *Detalhes* 


| Vers√£o ONTAP | ONTAP 9.7+ (licen√ßa FlexCache n√£o necess√°ria) 


| Licen√ßa FlexCache | Requerido no ONTAP 9.6 e vers√µes anteriores. 


| Kubernetes | Clusters locais e em nuvem (EKS/GKE/AKS) 


| Trident | Instalado em clusters locais e na nuvem. 


| Union.ai | Plano de controle implantado (Union Cloud ou auto-hospedado) 


| Rede | Conectividade entre clusters (se os clusters ONTAP forem separados) 


| Permiss√µes  a| 
Acesso administrativo aos clusters ONTAP e Kubernetes.

‚úÖUse as credenciais ONTAP corretas (por exemplo, vsadmin)



| √â novo(a) na Union.ai? | Consulte o guia complementar no final deste documento. 
|===


== Arquitetura de refer√™ncia

A figura a seguir mostra o plano de controle do Union.ai integrado ao armazenamento NetApp para treinamento h√≠brido de IA.

image::ai-hybrid-union-001.png[Arquitetura h√≠brida de treinamento de IA com Union.ai e NetApp]

* Union.ai Control Plane: Orquestra fluxos de trabalho, gerencia a movimenta√ß√£o de dados e integra-se com as APIs da NetApp .
* NetApp ONTAP + FlexCache: Oferece armazenamento em cache de dados eficiente, desde ambientes locais at√© a nuvem.
* Clusters de treinamento h√≠bridos: as tarefas de treinamento s√£o executadas em clusters K8s na nuvem (por exemplo, EKS) com dados armazenados em cache no ambiente local.




=== _Etapa 1: Criar um volume FlexCache

Utilizando o Gerenciador de Sistemas ONTAP

. Acesse Armazenamento > Volumes.
. Clique em Adicionar.
. Selecione Mais op√ß√µes.
. Ative a op√ß√£o "Adicionar como cache" para um volume remoto.
. Escolha seus volumes de origem (local) e destino (nuvem).
. Defina o n√≠vel de QoS ou desempenho (opcional).
. Clique em Criar.


üí°Se o NetApp DataOps Toolkit n√£o estiver funcionando devido a problemas de permiss√£o ou agrega√ß√£o, crie o volume FlexCache diretamente usando o ONTAP System Manager ou a CLI.



=== _Etapa 2: Configurar o Trident_

Instale o Trident em ambos os clusters:

üîó https://docs.netapp.com/us-en/trident/trident-get-started/kubernetes-deploy.html["+++ Guia de Instala√ß√£o do Trident +++"]

Criar Backend Trident

[source, cli]
----
apiVersion: trident.netapp.io/v1
kind: TridentBackendConfig
metadata:
name: ontap-flexcache
spec:
version: 1
storageDriverName: ontap-nas
managementLIF: <ONTAP-MGMT-IP>
dataLIF: <ONTAP-DATA-IP>
svm: <SVM-NAME>
username: vsadmin
password: <password>

Apply: kubectl apply -f backend-flexcache.yaml
----
Se voc√™ receber um erro 401 N√£o autorizado, verifique se o usu√°rio do ONTAP possui permiss√µes de API suficientes e se o nome de usu√°rio (vsadmin) e a senha corretos est√£o sendo usados.

Defina a classe de armazenamento.

[source, cli]
----
apiVersion: storage.k8s.io/v1
kind: StorageClass
metadata:
name: flexcache-sc
provisioner: csi.trident.netapp.io
parameters:
backendType: "ontap-nas"
Apply:
kubectl apply -f storageclass-flexcache.yaml
----


=== _Etapa 3: Implantar fluxos de trabalho do Union.ai_

A Union usa PVCs para montar volumes FlexCache em tarefas de treinamento.

Exemplo de modelo de Pod

[source, cli]
----
apiVersion: v1
kind: PodTemplate
metadata:
name: netapp-podtemplate
namespace: flytesnacks-development
template:
metadata:
labels:
default-storage: netapp
spec:
containers:
- name: primary
volumeMounts:
- name: flexcache-storage
mountPath: /data/flexcache
volumes:
- name: flexcache-storage
persistentVolumeClaim:
claimName: flexcache-pvc
----
Exemplo de fluxo de trabalho

da tarefa de importa√ß√£o de uni√£o, fluxo de trabalho

[source, cli]
----
@task(pod_template="netapp-podtemplate")

def train_model(pvc_path: str):
----


= Carregar e treinar com dados do PVC

[source, cli]
----
@workflow

def training_pipeline():

train_model(pvc_path="/data/flexcache")
----
O operador sindicalizado ir√°:

* Criar o PVC
* Monte o volume FlexCache
* Agende a tarefa no cluster Kubernetes na nuvem.




=== Etapa 4: Validar a integra√ß√£o_

[cols="21%,79%"]
|===
| *Tarefa* | *Valida√ß√£o* 


| Suporte de PVC | Os pods de treinamento devem montar /data/flexcache com sucesso. 


| Acesso a dados | Os trabalhos de treinamento podem ler/gravar no FlexCache. 


| Comportamento do cache | Monitorar acertos/falhas de cache no ONTAP.  Garantir que os agregados suportem FlexCache 


| Desempenho | Validar a lat√™ncia e a taxa de transfer√™ncia para cargas de trabalho de treinamento. 
|===
Utilize a CLI do NetApp BlueXP ou do ONTAP para monitorar o desempenho.



== Considera√ß√µes de seguran√ßa

* Use endpoints VPC para FSx para NetApp ONTAP
* Habilite a criptografia em tr√¢nsito e em repouso.
* Aplicar RBAC/IAM para acesso ao ONTAP
* A Union.ai n√£o acessa nem armazena dados de clientes.




== Monitoramento e Otimiza√ß√£o

[cols="31%,69%"]
|===


| *Ferramenta* | *Prop√≥sito* 


| NetApp BlueXP | Monitore o uso e o desempenho do FlexCache. 


| Interface do usu√°rio Union.ai | Acompanhe o status e as m√©tricas do pipeline. 


| Registros de Trident | Depurar problemas de PVC ou backend 
|===
*Aprimoramentos opcionais*

* Automatize a cria√ß√£o do FlexCache usando as APIs do BlueXP.
* Use o Union SDK para aquecer o cache antes do treinamento.
* Adicione pipelines de infer√™ncia em lote ou de disponibiliza√ß√£o de modelos ap√≥s o treinamento.
* Se o DataOps Toolkit falhar, recorra √† cria√ß√£o manual do FlexCache por meio do Gerenciador de Sistemas.


*Solu√ß√£o de problemas*

[cols="41%,59%"]
|===
| _Emitir_ | _Resolu√ß√£o_ 


| PVC preso em Pendente | Verifique os logs do Trident e a configura√ß√£o do backend. 


| 401 N√£o autorizado da API ONTAP | Use o vsadmin e verifique as permiss√µes. 


| Tarefa falhou: N√£o h√° armazenamento adequado. | Garantir que o agregado ONTAP suporte FlexCache/ FabricPool 


| Desempenho lento no treinamento | Verifique a taxa de acertos de cache e a lat√™ncia da rede. 


| Os dados n√£o est√£o sendo sincronizados. | Validar a integridade do relacionamento do FlexCache no ONTAP 
|===
*Pr√≥ximos passos*

. Valide o FlexCache com dados de teste.
. Implantar pipelines de treinamento da Union.ai
. Monitorar e otimizar o desempenho
. Documente a configura√ß√£o espec√≠fica do cliente.




== Links relacionados

* https://docs.union.ai["+++Documenta√ß√£o do Union.ai+++"]
* https://docs.netapp.com/us-en/ontap/flexcache/index.html["+++ Vis√£o geral do NetApp FlexCache +++"]
* https://docs.netapp.com/us-en/trident/index.html["+++ Motorista Trident CSI +++"]
* https://docs.aws.amazon.com/fsx/latest/ONTAPGuide/what-is-fsx-ontap.html["+++FSx para NetApp ONTAP+++"]




== Conclus√£o

Agora voc√™ possui um ambiente de treinamento de IA h√≠brido validado usando Union.ai e NetApp FlexCache.  Os trabalhos de treinamento podem ser executados na nuvem, acessando dados locais de forma segura e eficiente, sem replicar conjuntos de dados inteiros ou comprometer a governan√ßa.



=== *Guia Complementar do Union.ai*



==== *Etapa 1: Escolha o modelo de implanta√ß√£o*

*Op√ß√£o A: Union Cloud*

* Visita: https://console.union.ai["+++console.union.ai+++"]
* Criar organiza√ß√£o ‚Üí Criar projeto


*Op√ß√£o B: Hospedagem pr√≥pria*

* Seguir:https://docs.union.ai/platform/latest/deployment/self-hosted/["+++Guia de Hospedagem Pr√≥pria+++"]
* Implanta√ß√£o via Helm:


helm repo adicionar unionai https://unionai.github.io/helm-charts/[]

helm install union unionai/union -n union-system -f values.yaml



==== *Etapa 2: Instalar o Union Operator*

**Ó∞É**kubectl apply -fhttps://raw.githubusercontent.com/unionai/operator/main/deploy/operator.yaml[]

kubectl get pods -n union-system

Ó∞Ç



==== *Etapa 3: Instale o Union CLI*

**Ó∞É**pip install unionai

login da uni√£o

Ó∞Ç



==== *Etapa 4: Registrar o fluxo de trabalho*

**Ó∞É**projeto de uni√£o cria IA h√≠brida

union register training_pipeline.py --project hybrid-ai

Ó∞Ç



==== *Etapa 5: Executar e Monitorar*

**Ó∞É**union run training_pipeline --project hybrid-ai

Treinamento de vigil√¢ncia sindical_pipeline

Veja os registros em https://console.union.ai["+++Interface de usu√°rio da Uni√£o+++"]



==== *Etapa 6: Registrar o cluster de computa√ß√£o (opcional)*

**Ó∞É**union cluster register --name cloud-k8s --kubeconfig ~/.kube/config



==== *Etapa 7: Rastrear artefatos e linhagem*

O Union rastreia automaticamente:

* Par√¢metros de entrada/sa√≠da
* Vers√µes de dados
* Registros e m√©tricas
* Linhagem de execu√ß√£o

